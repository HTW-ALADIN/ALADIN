import{i as Re,o as Qe,S as et}from"./index-8ac73e8f.js";import{d as q,e as Ne,D as tt,y as Ie,_ as R,c as j,b as I,o as E,p as $e,a as ke,x as ze,i as te,l as nt,t as oe,B as Ze,r as K,h as W,w as ce,T as ot,F as ae,n as re,E as at,m as V,j as je,G as Fe,z as We,H as rt,A as st,I as Te,J as He,K as Be,M as it,L as ct,N as lt,O as dt,P as ut,Q as pt,V as _t,C as mt,R as vt,S as ft,U as ht,W as gt,X as yt,Y as bt,Z as wt,$ as xt,a0 as St,a1 as Ct,g as ve}from"./index-ac1dbb22.js";var B=function(){return B=Object.assign||function(e){for(var o,n=1,r=arguments.length;n<r;n++){o=arguments[n];for(var c in o)Object.prototype.hasOwnProperty.call(o,c)&&(e[c]=o[c])}return e},B.apply(this,arguments)};typeof window<"u"&&(window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),typeof window.CustomEvent!="function"&&(window.CustomEvent=function(e,o){o=o||{bubbles:!1,cancelable:!1,detail:null};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,o.bubbles,o.cancelable,o.detail),n}));function Ye(t,e){for(var o=t.length;o--;)if(t[o].pointerId===e.pointerId)return o;return-1}function Me(t,e){var o;if(e.touches){o=0;for(var n=0,r=e.touches;n<r.length;n++){var c=r[n];c.pointerId=o++,Me(t,c)}return}o=Ye(t,e),o>-1&&t.splice(o,1),t.push(e)}function Ot(t,e){if(e.touches){for(;t.length;)t.pop();return}var o=Ye(t,e);o>-1&&t.splice(o,1)}function Ve(t){t=t.slice(0);for(var e=t.pop(),o;o=t.pop();)e={clientX:(o.clientX-e.clientX)/2+e.clientX,clientY:(o.clientY-e.clientY)/2+e.clientY};return e}function xe(t){if(t.length<2)return 0;var e=t[0],o=t[1];return Math.sqrt(Math.pow(Math.abs(o.clientX-e.clientX),2)+Math.pow(Math.abs(o.clientY-e.clientY),2))}var le={down:"mousedown",move:"mousemove",up:"mouseup mouseleave"};typeof window<"u"&&(typeof window.PointerEvent=="function"?le={down:"pointerdown",move:"pointermove",up:"pointerup pointerleave pointercancel"}:typeof window.TouchEvent=="function"&&(le={down:"touchstart",move:"touchmove",up:"touchend touchcancel"}));function Se(t,e,o,n){le[t].split(" ").forEach(function(r){e.addEventListener(r,o,n)})}function Ce(t,e,o){le[t].split(" ").forEach(function(n){e.removeEventListener(n,o)})}var Pt=typeof document<"u"&&!!document.documentMode,Oe;function Et(){return Oe||(Oe=document.createElement("div").style)}var qe=["webkit","moz","ms"],de={};function De(t){if(de[t])return de[t];var e=Et();if(t in e)return de[t]=t;for(var o=t[0].toUpperCase()+t.slice(1),n=qe.length;n--;){var r="".concat(qe[n]).concat(o);if(r in e)return de[t]=r}}function ue(t,e){return parseFloat(e[De(t)])||0}function pe(t,e,o){o===void 0&&(o=window.getComputedStyle(t));var n=e==="border"?"Width":"";return{left:ue("".concat(e,"Left").concat(n),o),right:ue("".concat(e,"Right").concat(n),o),top:ue("".concat(e,"Top").concat(n),o),bottom:ue("".concat(e,"Bottom").concat(n),o)}}function ne(t,e,o){t.style[De(e)]=o}function Tt(t,e){var o=De("transform");ne(t,"transition","".concat(o," ").concat(e.duration,"ms ").concat(e.easing))}function Mt(t,e,o){var n=e.x,r=e.y,c=e.scale,a=e.isSVG;if(ne(t,"transform","scale(".concat(c,") translate(").concat(n,"px, ").concat(r,"px)")),a&&Pt){var s=window.getComputedStyle(t).getPropertyValue("transform");t.setAttribute("transform",s)}}function Pe(t){var e=t.parentNode,o=window.getComputedStyle(t),n=window.getComputedStyle(e),r=t.getBoundingClientRect(),c=e.getBoundingClientRect();return{elem:{style:o,width:r.width,height:r.height,top:r.top,bottom:r.bottom,left:r.left,right:r.right,margin:pe(t,"margin",o),border:pe(t,"border",o)},parent:{style:n,width:c.width,height:c.height,top:c.top,bottom:c.bottom,left:c.left,right:c.right,padding:pe(e,"padding",n),border:pe(e,"border",n)}}}function Nt(t){var e=t.ownerDocument,o=t.parentNode;return e&&o&&e.nodeType===9&&o.nodeType===1&&e.documentElement.contains(o)}function It(t){return(t.getAttribute("class")||"").trim()}function $t(t,e){return t.nodeType===1&&" ".concat(It(t)," ").indexOf(" ".concat(e," "))>-1}function kt(t,e){for(var o=t;o!=null;o=o.parentNode)if($t(o,e.excludeClass)||e.exclude.indexOf(o)>-1)return!0;return!1}var zt=/^http:[\w\.\/]+svg$/;function jt(t){return zt.test(t.namespaceURI)&&t.nodeName.toLowerCase()!=="svg"}function Dt(t){var e={};for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);return e}var Xe={animate:!1,canvas:!1,cursor:"move",disablePan:!1,disableZoom:!1,disableXAxis:!1,disableYAxis:!1,duration:200,easing:"ease-in-out",exclude:[],excludeClass:"panzoom-exclude",handleStartEvent:function(t){t.preventDefault(),t.stopPropagation()},maxScale:4,minScale:.125,overflow:"hidden",panOnlyWhenZoomed:!1,pinchAndPan:!1,relative:!1,setTransform:Mt,startX:0,startY:0,startScale:1,step:.3,touchAction:"none"};function Je(t,e){if(!t)throw new Error("Panzoom requires an element as an argument");if(t.nodeType!==1)throw new Error("Panzoom requires an element with a nodeType of 1");if(!Nt(t))throw new Error("Panzoom should be called on elements that have been attached to the DOM");e=B(B({},Xe),e);var o=jt(t),n=t.parentNode;n.style.overflow=e.overflow,n.style.userSelect="none",n.style.touchAction=e.touchAction,(e.canvas?n:t).style.cursor=e.cursor,t.style.userSelect="none",t.style.touchAction=e.touchAction,ne(t,"transformOrigin",typeof e.origin=="string"?e.origin:o?"0 0":"50% 50%");function r(){n.style.overflow="",n.style.userSelect="",n.style.touchAction="",n.style.cursor="",t.style.cursor="",t.style.userSelect="",t.style.touchAction="",ne(t,"transformOrigin","")}function c(l){l===void 0&&(l={});for(var h in l)l.hasOwnProperty(h)&&(e[h]=l[h]);(l.hasOwnProperty("cursor")||l.hasOwnProperty("canvas"))&&(n.style.cursor=t.style.cursor="",(e.canvas?n:t).style.cursor=e.cursor),l.hasOwnProperty("overflow")&&(n.style.overflow=l.overflow),l.hasOwnProperty("touchAction")&&(n.style.touchAction=l.touchAction,t.style.touchAction=l.touchAction)}var a=0,s=0,i=1,S=!1;v(e.startScale,{animate:!1,force:!0}),setTimeout(function(){g(e.startX,e.startY,{animate:!1,force:!0})});function O(l,h,C){if(!C.silent){var $=new CustomEvent(l,{detail:h});t.dispatchEvent($)}}function u(l,h,C){var $={x:a,y:s,scale:i,isSVG:o,originalEvent:C};return requestAnimationFrame(function(){typeof h.animate=="boolean"&&(h.animate?Tt(t,h):ne(t,"transition","none")),h.setTransform(t,$,h),O(l,$,h),O("panzoomchange",$,h)}),$}function P(l,h,C,$){var p=B(B({},e),$),T={x:a,y:s,opts:p};if(!p.force&&(p.disablePan||p.panOnlyWhenZoomed&&i===p.startScale))return T;if(l=parseFloat(l),h=parseFloat(h),p.disableXAxis||(T.x=(p.relative?a:0)+l),p.disableYAxis||(T.y=(p.relative?s:0)+h),p.contain){var x=Pe(t),G=x.elem.width/i,F=x.elem.height/i,se=G*C,ie=F*C,Q=(se-G)/2,ee=(ie-F)/2;if(p.contain==="inside"){var ge=(-x.elem.margin.left-x.parent.padding.left+Q)/C,ye=(x.parent.width-se-x.parent.padding.left-x.elem.margin.left-x.parent.border.left-x.parent.border.right+Q)/C;T.x=Math.max(Math.min(T.x,ye),ge);var be=(-x.elem.margin.top-x.parent.padding.top+ee)/C,we=(x.parent.height-ie-x.parent.padding.top-x.elem.margin.top-x.parent.border.top-x.parent.border.bottom+ee)/C;T.y=Math.max(Math.min(T.y,we),be)}else if(p.contain==="outside"){var ge=(-(se-x.parent.width)-x.parent.padding.left-x.parent.border.left-x.parent.border.right+Q)/C,ye=(Q-x.parent.padding.left)/C;T.x=Math.max(Math.min(T.x,ye),ge);var be=(-(ie-x.parent.height)-x.parent.padding.top-x.parent.border.top-x.parent.border.bottom+ee)/C,we=(ee-x.parent.padding.top)/C;T.y=Math.max(Math.min(T.y,we),be)}}return p.roundPixels&&(T.x=Math.round(T.x),T.y=Math.round(T.y)),T}function b(l,h){var C=B(B({},e),h),$={scale:i,opts:C};if(!C.force&&C.disableZoom)return $;var p=e.minScale,T=e.maxScale;if(C.contain){var x=Pe(t),G=x.elem.width/i,F=x.elem.height/i;if(G>1&&F>1){var se=x.parent.width-x.parent.border.left-x.parent.border.right,ie=x.parent.height-x.parent.border.top-x.parent.border.bottom,Q=se/G,ee=ie/F;e.contain==="inside"?T=Math.min(T,Q,ee):e.contain==="outside"&&(p=Math.max(p,Q,ee))}}return $.scale=Math.min(Math.max(l,p),T),$}function g(l,h,C,$){var p=P(l,h,i,C);return a!==p.x||s!==p.y?(a=p.x,s=p.y,u("panzoompan",p.opts,$)):{x:a,y:s,scale:i,isSVG:o,originalEvent:$}}function v(l,h,C){var $=b(l,h),p=$.opts;if(!(!p.force&&p.disableZoom)){l=$.scale;var T=a,x=s;if(p.focal){var G=p.focal;T=(G.x/l-G.x/i+a*l)/l,x=(G.y/l-G.y/i+s*l)/l}var F=P(T,x,l,{relative:!1,force:!0});return a=F.x,s=F.y,i=l,u("panzoomzoom",p,C)}}function y(l,h){var C=B(B(B({},e),{animate:!0}),h);return v(i*Math.exp((l?1:-1)*C.step),C)}function d(l){return y(!0,l)}function m(l){return y(!1,l)}function _(l,h,C,$){var p=Pe(t),T={width:p.parent.width-p.parent.padding.left-p.parent.padding.right-p.parent.border.left-p.parent.border.right,height:p.parent.height-p.parent.padding.top-p.parent.padding.bottom-p.parent.border.top-p.parent.border.bottom},x=h.clientX-p.parent.left-p.parent.padding.left-p.parent.border.left-p.elem.margin.left,G=h.clientY-p.parent.top-p.parent.padding.top-p.parent.border.top-p.elem.margin.top;o||(x-=p.elem.width/i/2,G-=p.elem.height/i/2);var F={x:x/T.width*(T.width*l),y:G/T.height*(T.height*l)};return v(l,B(B({},C),{animate:!1,focal:F}),$)}function f(l,h){l.preventDefault();var C=B(B(B({},e),h),{animate:!1}),$=l.deltaY===0&&l.deltaX?l.deltaX:l.deltaY,p=$<0?1:-1,T=b(i*Math.exp(p*C.step/3),C).scale;return _(T,l,C,l)}function M(l){var h=B(B(B({},e),{animate:!0,force:!0}),l);i=b(h.startScale,h).scale;var C=P(h.startX,h.startY,i,h);return a=C.x,s=C.y,u("panzoomreset",h)}var w,k,z,D,A,H,N=[];function L(l){if(!kt(l.target,e)){Me(N,l),S=!0,e.handleStartEvent(l),w=a,k=s,O("panzoomstart",{x:a,y:s,scale:i,isSVG:o,originalEvent:l},e);var h=Ve(N);z=h.clientX,D=h.clientY,A=i,H=xe(N)}}function J(l){if(!(!S||w===void 0||k===void 0||z===void 0||D===void 0)){Me(N,l);var h=Ve(N),C=N.length>1,$=i;if(C){H===0&&(H=xe(N));var p=xe(N)-H;$=b(p*e.step/80+A).scale,_($,h,{animate:!1},l)}(!C||e.pinchAndPan)&&g(w+(h.clientX-z)/$,k+(h.clientY-D)/$,{animate:!1},l)}}function U(l){N.length===1&&O("panzoomend",{x:a,y:s,scale:i,isSVG:o,originalEvent:l},e),Ot(N,l),S&&(S=!1,w=k=z=D=void 0)}var Y=!1;function Z(){Y||(Y=!0,Se("down",e.canvas?n:t,L),Se("move",document,J,{passive:!0}),Se("up",document,U,{passive:!0}))}function X(){Y=!1,Ce("down",e.canvas?n:t,L),Ce("move",document,J),Ce("up",document,U)}return e.noBind||Z(),{bind:Z,destroy:X,eventNames:le,getPan:function(){return{x:a,y:s}},getScale:function(){return i},getOptions:function(){return Dt(e)},handleDown:L,handleMove:J,handleUp:U,pan:g,reset:M,resetStyle:r,setOptions:c,setStyle:function(l,h){return ne(t,l,h)},zoom:v,zoomIn:d,zoomOut:m,zoomToPoint:_,zoomWithWheel:f}}Je.defaultOptions=Xe;const At=(t,e,o="")=>{const{getProperty:n,setProperty:r,store:c}=t,a=Yt(t),s=JSON.parse(JSON.stringify(a.components)),i=c.state.currentNode;n(e.secondaryNeedsVector);const S=n(e.baseMatrix),O=parseInt(e.baseMatrix[e.baseMatrix.length-1]),u=n(e.n)-1,P=(D,A,H,N)=>{const L=JSON.parse(JSON.stringify(D));return L.dependencies.Matrix.data=`nodes__${A}__components__${H}__component__userData`,L.dependencies.Matrix.data1=`nodes__${A}__components__${N}__component__userData`,L.isValid=!1,L.component.readOnly=!1,L.methods={fillZeros:{description:"Ergänze Nullen",impact:.5},showSolution:{description:"Zeige Lösung",impact:0},copyToClipboard:{description:"Kopieren",impact:1}},L.component.initialize.solution.operations=[{name:"multiply",args:["chain"]}],L.component.initialize.solution.paths=[`nodes__${A}__components__${H}__component__userData`,`nodes__${A}__components__${N}__component__userData`],L.component.initialize.user.operations=[{name:"getValueInitializedMatrix",args:[null]}],A%2!==0&&(L.component.initialize.validation.operations=[{name:"getValueInitializedMatrix",args:[{isValid:!1,isCorrect:!1}]}],L.component.initialize.validation.paths=["taskData__adjacencyMatrix"]),L},b=(D,A,H)=>{const N=JSON.parse(JSON.stringify(D));return N.dependencies.Matrix.data=`nodes__${A}__components__${H[H.length-1]}__component__solutionData`,N.name="Gesamtbedarfsmatrix",N.isValid=!1,N.component.readOnly=!1,N.methods={fillZeros:{description:"Ergänze Nullen",impact:.5},showSolution:{description:"Zeige Lösung",impact:0},copyToClipboard:{description:"Kopieren",impact:1}},N.component.initialize.solution.operations=Array(u+1).fill(null).map(()=>({name:"add",args:["chain"]})),N.component.initialize.solution.paths=H.map(L=>`nodes__${A}__components__${L}__component__userData`),N.component.initialize.user.operations=[{name:"getValueInitializedMatrix",args:[null]}],N},g=(D,A,H,N)=>Object.entries(D).reduce((J,[U,Y])=>{const Z=Y.filter(l=>l.i===O)[0],X=[...Y,{...Z,i:A,y:Z.y-Z.h*N,x:Z.x+Z.w*H}];return J[U]=X,J},{}),v=(D,A,H)=>Object.entries(D).reduce((L,[J,U])=>{const Y=U.filter(X=>X.i===O)[0],Z=U.map(X=>X.i===H?{...X,x:Y.x+Y.w*A}:X);return L[J]=Z,L},{});let y=a.layouts,d=O,m=Object.keys(s).length,_=m,f=1;const M=parseInt(Object.keys(s)[1]),w=parseInt(Object.keys(s)[2]),k=parseInt(Object.keys(s)[3]),z=[O,M];for(let D=0;D<u;D++)s[m]=JSON.parse(JSON.stringify(S)),y=g(y,m,f,1),_=m+1,s[_]=P(S,i,d,m),y=g(y,_,f,0),m+=2,d=_,f++,z.push(_);y=v(y,f,M),f++,_+=1,s[_]=b(S,i,z),y=g(y,_,f,0),f++,y=v(y,f,w),y=v(y,f,k),r({path:`nodes__${i}__layouts`,value:y}),r({path:`nodes__${i}__components`,value:s})},_e=window.MathLex;var Ue=2;const fe=t=>parseFloat(parseFloat(t).toFixed(Ue)),Lt=(t,e,o="0")=>{const{getProperty:n,setProperty:r}=t,c=n("currentNode");Ue=n(e.decimals);const a=n(e.formula)||"",s=n(e.texFormula)||"",i=Object.entries(n(e.variables)).reduce((v,[y,d])=>(v[y]=n(d),v),{}),S=_e.parse(a),O=_e.parse(s),u=_e.render(O,"latex"),P=_e.render(S,"sage"),b=me(S,i),g=Ae(b,i);r({path:`nodes__${c}__components__${o}__component__tex`,value:u}),r({path:`nodes__${c}__components__${o}__component__sage`,value:P}),r({path:`nodes__${c}__components__${o}__component__aladinAST`,value:g}),r({path:`nodes__${c}__components__${o}__component__AST`,value:b})},Ae=(t,e,o=null)=>{const n=Object.keys(t);if(n.includes("type")&&t.type==="variable"){let a;t.index?(a=e[t.name][o],t=[{type:"scalar",value:fe(a),userValue:"",valueType:"variable"}]):(a=e[t.name],t=[{type:"scalar",value:fe(a),userValue:"",valueType:"variableConstant"}])}const c=(a=>{const s=["slots","terms","rightTerm","leftTerm"];for(let i of a)if(s.includes(i))return t[i];return null})(n);if(c)for(let a=0;a<c.length;a++){const s=c[a];let i=Ae(s,e,o);Array.isArray(i)&&(i=i[0]),c[a]=i}return t},Ht=(t,e,o)=>[{type:"scalar",value:`(- ${fe(e)})`,datatype:o,userValue:"",valueType:"constant"}],Bt=(t,e,o)=>[{type:"power",slots:[{name:"base",terms:e},{name:"exponent",terms:o}]}],Vt=(t,e,o)=>({leftTerm:e,comparisonOperator:t,rightTerm:o}),qt=(t,e,o)=>[{type:"fraction",slots:[{name:"numerator",terms:e},{name:"denominator",terms:o}]}],Ee=(t,e,o)=>[{type:"BaseOperation",options:{operation:{Plus:"+",Minus:"-",Times:"*"}[t]},slots:[{name:"firstOperand",terms:e},{name:"secondOperand",terms:o}]}],Gt=(t,e,o)=>[{...e[0],index:o[0].name}],Rt=(t,e,o)=>o,Zt=(t,e,o)=>{const n=()=>{const[a,s,i,S]=e,O=i[0].value,u=o[S[0].name],b={sum:"+",prod:"*"}[t],g=d=>JSON.parse(JSON.stringify(d));let v,y;for(let d=O;d<u;d++){const m=Ae(g(a[0]),o,d);if(d===O){y=m;continue}const _={type:"BaseOperation",options:{operation:b},slots:[{name:"firstOperand",terms:[y]},{name:"secondOperand",terms:[m]}]};y=_,d===u-1&&(v=_)}return[v]},r=()=>{const[a,s]=e,i={name:"radicand",terms:a};return s&&s[0]&&[0,1,2].includes(s[0].value)?[{type:"radical",slots:[i]}]:[{type:"radical",slots:[{name:"index",terms:s},i]}]};return{sum:n,prod:n,root:r,sqrt:r}[t]()},Ft={Equal:(t,e,o)=>Vt({Equal:"=",Less:"<",Greater:">",LessEqual:"<=",GreaterEqual:">=",Unequal:"!="}[t],e,o),Plus:Ee,Minus:Ee,Times:Ee,Divide:qt,Exponent:Bt,Negative:Ht,Subscript:Gt,Inclusion:Rt},me=(t,e)=>{let[o,n,r]=t;if(typeof n=="string"){if(o==="Literal")return[{type:"scalar",value:fe(r),datatype:n,userValue:"",valueType:"constant"}];if(o==="Variable")return[{type:"variable",name:n}]}if(o==="Function"){const s=n[1],i=r.map(S=>me(S,e));return Zt(s,i,e)}const c=me(n,e),a=me(r,e);return Ft[o](o,c,a)},Ge={matrixSelfMultiplication:At,formulaGenerator:Lt},Wt=async(t,e,o)=>{let n=0;for(const r of e){const{method:c,dependencies:a,applied:s,component_id:i}=r;if(!s){if(Reflect.has(Ge,c))await Ge[c](t,a,i),t.setProperty({path:`${o}__${n}__applied`,value:!0});else try{await new Function(c)(t,a,i),t.setProperty({path:`${o}__${n}__applied`,value:!0})}catch(S){throw new Error(`Unknown interjection method.
${S}`)}n++}}},Yt=t=>{const{getProperty:e}=t,n=`nodes__${e("currentNode")}`;return e(n)};var Le=(t=>(t.DRAGELEMENTCLASS="draggable",t))(Le||{});const Xt={props:{storeObject:Object},setup(t){const{getProperty:e}=t.storeObject;let o=document.querySelector("#resizeCanvas");const n=[.2,.9],r=q(()=>e("currentNode")),c=q(()=>e("topology")),a=q(()=>e("edges"));let s=!1;Ne(()=>{window.addEventListener("resize",g),o=document.querySelector("#resizeCanvas"),s=!1,b();const{depth:d,width:m,layout:_}=u(o);P(o,d,m,_,a),g()}),tt(()=>{window.removeEventListener("resize",g)});const i=d=>d,S=d=>d[0].map((m,_)=>d.map(f=>f[_])),O=()=>{const d=document.querySelector("#minimap"),m=document.querySelector(".minimap_collapse");s=!s,s?(d.style.display="none",m.innerHTML="&square;"):(d.style.display="block",m.innerHTML="_")},u=d=>{const m=c.value.length,_=i(c.value)[0].length,f=S(c.value),M=d.offsetWidth/_,w=d.offsetHeight/m;let k=M/2,z=w/2;const D={};for(let A=0;A<_;A++){for(let H=0;H<m;H++){const N=f[A][H];N!==null&&(D[N]=[k,z]),z+=w}z=w/2,k+=M}return{depth:m,width:M,layout:D}},P=(d,m,_,f,M)=>{const w=d.getContext("2d");w.lineWidth=5,w.fillStyle="green",w.strokeStyle="green",Object.entries(f).forEach(([k,z])=>{v(w,...z),M.value[k].forEach(D=>{const A=f[D];w.setLineDash([2,4]),w.fillStyle="red",w.strokeStyle="red",w.globalCompositeOperation="destination-over",y(w,z[0],z[1],A[0],A[1],_),w.globalCompositeOperation="destination-under",w.setLineDash([])})})},b=()=>{const d=document.querySelector("html").clientWidth*n[0],m=document.querySelector("html").clientHeight*n[1];o.width=d,o.height=m;const _=document.querySelector("#minimap");_.style.backgroundColor="lightgrey",_.width=d,_.height=m},g=()=>{const d=document.querySelector("#minimap"),m=document.querySelector("html").clientWidth*n[0],_=document.querySelector("html").clientHeight*n[1],f=o.width,M=o.height;d.width=m,d.height=_,d.getContext("2d").drawImage(o,0,0,f,M,0,0,m,_)},v=(d,m,_,f=15)=>{d.beginPath(),d.arc(m,_,f,0,2*Math.PI),d.stroke(),d.fill(),d.closePath()},y=(d,m,_,f,M,w)=>{if(d.beginPath(),d.moveTo(m,_),m!==f){const k=(f>m?f/m:m/f)/2;m<f?d.quadraticCurveTo(w*k,_,f,M):d.quadraticCurveTo(w*k,M,f,M)}else d.lineTo(f,M);d.stroke(),d.closePath()};return Ie(r,()=>{}),{minimize:O}}};const Ke=t=>($e("data-v-a72cdf42"),t=t(),ke(),t),Jt=Ke(()=>I("canvas",{id:"minimap"},null,-1)),Ut=Ke(()=>I("canvas",{id:"resizeCanvas"},null,-1));function Kt(t,e,o,n,r,c){return E(),j("div",null,[Jt,I("button",{class:"minimap_collapse",onClick:e[0]||(e[0]=(...a)=>n.minimize&&n.minimize(...a))},"_"),Ut])}const Qt=R(Xt,[["render",Kt],["__scopeId","data-v-a72cdf42"]]),en={props:{storeObject:Object},setup(t){const{getProperty:e,setProperty:o}=t.storeObject,n=e("taskMode"),r=ze(),c=e("rootNode"),a=e("currentNode"),s=q(()=>{const v=e("edges")[a];return v?v[0]:null}),i=q(()=>e("previousNode")),S=c==a,O=v=>{const y=e("edges");return Object.entries(y).reduce((m,[_,f])=>(f.includes(v)&&(m=parseInt(_)),m),-1)},u=q(()=>e(`nodes__${a}__components`)),P=()=>{const v=Object.values(u.value).every(d=>d.isCorrect===void 0?!0:d.isCorrect);return{isValid:n.value==="practice"?v&&Object.values(u.value).every(d=>d.isValid):Object.values(u.value).every(d=>d.isValid),isCorrect:v}},b=v=>{Array.from(document.querySelectorAll(".traverse.forward")).forEach(d=>{const m=d.querySelector(".validity");v?(d.classList.remove("inValid"),m.innerHTML="&#10004;"):m&&(d.classList.add("inValid"),m.innerHTML="&#33;")})};return Ne(()=>{const{isValid:v}=P();b(v)}),Ie(u,()=>{setTimeout(()=>{const{isValid:v,isCorrect:y}=P(),d=e(`nodes__${a}`);o({path:`nodes__${a}__isValid`,value:v}),"isCorrect"in d&&o({path:`nodes__${a}__isCorrect`,value:y}),b(v)},50)},{deep:!0}),{navigate:v=>{const y=v.currentTarget,{direction:d,to:m}=y.dataset,_=O(parseInt(m));!m&&d==="backward"?r.push({name:"TaskOverview"}):Array.from(y.classList).includes("inValid")||(o({path:"previousNode",value:_}),o({path:"currentNode",value:m}))},next:s,previous:i,isRootNote:S}}};const he=t=>($e("data-v-69364485"),t=t(),ke(),t),tn={class:"navigation"},nn=["data-to"],on=he(()=>I("div",{class:"validity"},"✔",-1)),an=he(()=>I("p",null,"►",-1)),rn=[on,an],sn=["data-to"],cn=he(()=>I("div",{class:"validity"},"!",-1)),ln=he(()=>I("p",null,"►",-1)),dn=[cn,ln];function un(t,e,o,n,r,c){return E(),j("nav",tn,[n.isRootNote?te("",!0):(E(),j("div",{key:0,class:"traverse backward","data-direction":"backward","data-to":n.previous,onClick:e[0]||(e[0]=(...a)=>n.navigate&&n.navigate(...a))},rn,8,nn)),n.next?(E(),j("div",{key:1,class:"traverse forward","data-direction":"forward","data-to":n.next,onClick:e[1]||(e[1]=(...a)=>n.navigate&&n.navigate(...a))},dn,8,sn)):te("",!0)])}const pn=R(en,[["render",un],["__scopeId","data-v-69364485"]]),_n={name:"Hint",props:{storeObject:Object},setup(t){const{store:e,getProperty:o,setProperty:n}=t.storeObject,r=e.state.currentNode,c=q(()=>{const O=o(`nodes__${r}__hints`);return O||{active:!1,current:0,descriptions:[]}});let a=nt("/img/lightbulb.png");return{hints:c,lightBulbSource:a,lightSwitch:O=>{const u=O.target,P=u.parentNode.querySelector(".hintText");Array.from(u.classList).includes("on")?(u.classList.remove("on"),a.value="/img/lightbulb.png",P.classList.add("closed"),n({path:`nodes__${r}__hints__active`,value:!1})):(u.classList.add("on"),a.value="/img/lightbulb_on.png",P.classList.remove("closed"),n({path:`nodes__${r}__hints__active`,value:!0}))},hintHandler:O=>{const u=O.currentTarget,{direction:P}=u.dataset;let b;P==="forward"?c.value.current>=c.value.descriptions.length-1?b=c.value.descriptions.length-1:b=c.value.current+1:c.value.current<=0?b=0:b=c.value.current-1,n({path:`nodes__${r}__hints__current`,value:b})},closeHandler:()=>{document.querySelector(".lightBulb.on")&&(document.querySelector(".lightBulb.on").classList.remove("on"),document.querySelector(".hintText").classList.add("closed"),a.value="/img/lightbulb.png",n({path:`nodes__${r}__hints__active`,value:!1}))}}}};const mn=["src"],vn={class:"hintText closed"},fn={class:"hintNavigation"},hn={class:"display"},gn=["innerHTML"];function yn(t,e,o,n,r,c){return n.hints.descriptions.length?(E(),j("div",{key:0,class:"hint",onClickout:e[3]||(e[3]=(...a)=>n.closeHandler&&n.closeHandler(...a))},[I("img",{class:"lightBulb off",src:n.lightBulbSource,onClick:e[0]||(e[0]=(...a)=>n.lightSwitch&&n.lightSwitch(...a))},null,8,mn),I("div",vn,[I("div",fn,[n.hints.descriptions.length>1?(E(),j("div",{key:0,class:"backward",onClick:e[1]||(e[1]=(...a)=>n.hintHandler&&n.hintHandler(...a)),"data-direction":"backward"},"<")):te("",!0),I("div",hn,oe(n.hints.current+1)+"/"+oe(n.hints.descriptions.length),1),n.hints.descriptions.length>1?(E(),j("div",{key:1,class:"forward",onClick:e[2]||(e[2]=(...a)=>n.hintHandler&&n.hintHandler(...a)),"data-direction":"forward"},">")):te("",!0)]),I("p",{innerHTML:n.hints.descriptions[n.hints.current]},null,8,gn)])],32)):te("",!0)}const bn=R(_n,[["render",yn],["__scopeId","data-v-fed12c44"]]),wn={name:"TextArea",props:{componentID:Number,storeObject:Object},setup(t){const{getProperty:e,setProperty:o}=t.storeObject,r=`nodes__${e("currentNode")}__components__${t.componentID}__component__value`;return{value:q(()=>e(r)),update:s=>{const i=s.currentTarget;o({path:r,value:i.value})}}}};const xn=["value"];function Sn(t,e,o,n,r,c){return E(),j("textarea",{class:"textarea",value:n.value,onInput:e[0]||(e[0]=(...a)=>n.update&&n.update(...a))}," ",40,xn)}const Cn=R(wn,[["render",Sn],["__scopeId","data-v-9c455e99"]]),On={name:"Modal",props:{storeObject:Object,modalIndex:Number},components:{Button:Ze},setup(t){const{store:e,getProperty:o,setProperty:n}=t.storeObject,r=e.state.currentNode,c=ze(),a=`nodes__${r}__modals__${t.modalIndex}`,s=q(()=>o(a)),i=q(()=>o(`${a}__active`)),S=q(()=>{const b=o(`nodes__${r}__components`);return Object.values(b).every(g=>g.isValid)});q(()=>{const b=o(`nodes__${r}__components`);return Object.values(b).every(g=>g.isValid)}),Ie(S,{completion:b=>{b&&(setTimeout(()=>{n({path:`${a}__active`,value:!0})},50),window.panzoom.setOptions({disablePan:!0}))},success:b=>{b&&setTimeout(()=>{n({path:`${a}__active`,value:!0}),window.panzoom.setOptions({disablePan:!0})},50)}}[s.value.trigger.type]);const u=()=>{n({path:`${a}__active`,value:!1}),window.panzoom.setOptions({disablePan:!1})};return{closeHandler:u,modal:s,active:i,buttonFunctions:{close:()=>u,route:b=>()=>{const{route:g}=b;c.push({name:g})}}}}};const Pn={key:0,class:"overlay"},En={class:"modal__header"},Tn={class:"modal__body"},Mn={class:"modal__footer"};function Nn(t,e,o,n,r,c){const a=K("Button");return E(),W(ot,{name:"fade",mode:"out-in"},{default:ce(()=>[n.active?(E(),j("div",Pn,[I("div",{class:"modal",onClickout:e[1]||(e[1]=(...s)=>n.closeHandler&&n.closeHandler(...s))},[I("div",{class:"closeModal",onClick:e[0]||(e[0]=(...s)=>n.closeHandler&&n.closeHandler(...s))},"X"),I("div",En,oe(n.modal.content.header),1),I("div",Tn,oe(n.modal.content.body),1),I("div",Mn,[(E(!0),j(ae,null,re(n.modal.content.footer.buttons,(s,i)=>(E(),W(a,{key:i,label:s.label,callback:n.buttonFunctions[s.type](s.parameters)},null,8,["label","callback"]))),128))])],32)])):te("",!0)]),_:1})}const In=R(On,[["render",Nn],["__scopeId","data-v-ee048682"]]);class $n extends at{validate(){return!1}getDropZoneBehaviours(){return{StoreDragElement:this.createStoreDragElementHandler()}}createStoreDragElementHandler(){const e=this.getComponentData(),o=this.storeObject,n=this.serialisedTaskComponentPath;return r=>{var S,O;const c=(S=r==null?void 0:r.target)==null?void 0:S.id,a=(O=r==null?void 0:r.relatedTarget)==null?void 0:O.id,s=V(e).dropZones[c].droppedElements,i=s?[...s,a]:[a];V(o).setProperty({path:`${n}__component__dropZones__${c}__droppedElements`,value:i})}}}const kn=["id"],zn=je({__name:"DropZone",props:{dropZoneCB:{},accept:{},dropZoneName:{},overlap:{default:"pointer"}},setup(t){const e=t;return Re(".dropZone").dropzone({overlap:V(e).overlap,ondrop:V(e).dropZoneCB,accept:V(e).accept.map(o=>`#${o}`).join(", ")}),(o,n)=>(E(),j("div",{class:"dropZone",id:e.dropZoneName},[Fe(o.$slots,"default",{},void 0,!0)],8,kn))}});const jn=R(zn,[["__scopeId","data-v-3ffdd6c0"]]),Dn=t=>{const e=t.interaction;if(e.pointerIsDown&&!e.interacting()){const o=t.currentTarget,n=t.currentTarget.cloneNode(!0),r=o.getBoundingClientRect();n.classList.add("dragging"),n.style.transform="translate(0px, 0px)",n.style.position="absolute",n.style.top=r.top+window.scrollY+"px",n.style.left=r.left+window.scrollX+"px",n.setAttribute("data-x","0"),n.setAttribute("data-y","0"),document.body.appendChild(n),e.start({name:"drag"},t.interactable,n)}},An=t=>{t.preventDefault();const e=t.target,o=(parseFloat(String(e.getAttribute("data-x")))||0)+t.dx/3,n=(parseFloat(String(e.getAttribute("data-y")))||0)+t.dy/3;e.style.transform=e.style.transform="translate("+o+"px, "+n+"px)",e.setAttribute("data-x",String(o)),e.setAttribute("data-y",String(n))},Ln=t=>{t.target.remove()},Hn=["id"],Bn=je({__name:"DragElement",props:{elementSelector:{}},setup(t){const e=t;return Re(".dragElement").draggable({manualStart:!0}).on("move",Dn).on("dragmove",An).on("dragend",Ln),(o,n)=>(E(),j("div",{class:We(["dragElement",V(Le).DRAGELEMENTCLASS]),id:e.elementSelector},[Fe(o.$slots,"default",{},void 0,!0)],10,Hn))}});const Vn=R(Bn,[["__scopeId","data-v-951cdf11"]]),qn={class:"dragElements"},Gn={class:"dropZones"},Rn=je({__name:"ItemPallet",props:{componentID:{},storeObject:{},componentPath:{},style:{}},setup(t){const e=t,o=rt(e),{storeObject:n,componentID:r,componentPath:c}=o,a=new $n(n,V(r),V(c)),s=a.getComponentData(),{dragElements:i,dropZones:S}=V(s),O=a.getNestedComponentPaths(),u=a.getDropZoneBehaviours();return(P,b)=>(E(),j("div",{class:"itemPallet",style:st(e.style??{})},[I("div",qn,[(E(!0),j(ae,null,re(V(i),(g,v)=>(E(),W(Vn,{class:"dragElement",key:v,elementSelector:g.elementSelector},{default:ce(()=>[(E(),W(Te(g.componentType),He(Be({componentID:V(r),componentPath:V(O)[v],storeObject:V(n),...g.props})),null,16))]),_:2},1032,["elementSelector"]))),128))]),I("div",Gn,[(E(!0),j(ae,null,re(V(S),(g,v)=>(E(),W(jn,{key:v,dropZoneCB:V(u)[g.dropZoneBehaviour],accept:g.accept,dropZoneName:String(v)},{default:ce(()=>[(E(),W(Te(g.componentType),He(Be({componentID:V(r),componentPath:V(O)[v],storeObject:V(n),...g.props,style:{width:"80%"}})),null,16))]),_:2},1032,["dropZoneCB","accept","dropZoneName"]))),128))])],4))}});const Zn=R(Rn,[["__scopeId","data-v-3037b92b"]]),Fn={name:"Canvas",components:{ItemPallet:Zn,ManipulatableGraph:it,BackgroundGraph:ct,ContourPlot:lt,MiniMap:Qt,Hint:bn,Matrix:dt,DOTGraph:ut,TaskConfiguration:pt,GridItem:Qe,GridLayout:et,Navigation:pn,VisualGraphTraversal:_t,CodeEditor:mt,Output:vt,Dropdown:ft,PathDisplay:ht,Equation:gt,TexDisplay:yt,DijkstraTable:bt,DijkstraGraph:wt,TextArea:Cn,Modal:In,PlanGraph:xt,EditableGraph:St,GanttDiagram:Ct},props:{storeObject:Object},setup(t){const{getProperty:e,setProperty:o,store:n}=t.storeObject,r=e("currentNode"),c=`nodes__${r}__interjections`,a=e(c)||[];Wt(t.storeObject,a,c);const s=e(`nodes__${r}__modals`),i=60,S=1e4/i,O=q(()=>e("zoomScale")),u=q(()=>e(`nodes__${r}__components`)),P=Object.keys(u.value).map(_=>_),b=q(()=>e(`nodes__${r}__layouts`)),g=q(()=>e("layoutSize")),v=q(()=>e(`nodes__${r}__layouts__${g.value}`)),y=(_=v.value.filter(f=>f.w===f.h).map(f=>f.i))=>{document.querySelector(".contourPlot")&&setTimeout(()=>{_.forEach(f=>{const M=document.querySelector(`.vgl-item[data-id="${f}"]`);M.style.height=M.style.width})},75)};return Ne(()=>{const _=document.querySelector(".zoomWrapper"),f=document.querySelector(".canvas"),M=Je(_,{excludeClass:"noPan",canvas:!0,startX:-document.querySelector(".zoomWrapper").clientWidth/2,startY:-document.querySelector(".zoomWrapper").clientHeight/2,silent:!1});window.panzoom=M,_.addEventListener("wheel",w=>{if(w.ctrlKey){M.zoomWithWheel(w,{animate:!0});const k=M.getScale();o({path:"zoomScale",value:k}),n.dispatch("trackZooming",{scale:k,timestamp:new Date().getTime(),x:w.clientX,y:w.clientY}),y()}w.preventDefault(),w.stopPropagation()}),_.addEventListener("panzoompan",w=>{const k=M.getPan();n.dispatch("trackPanning",{...k,timestamp:new Date().getTime()})}),f.addEventListener("wheel",w=>{w.preventDefault(),w.stopPropagation()}),y()}),o({path:"zoomScale",value:1}),{layouts:b,zoomScale:O,updateDimensions:(_,f,M)=>{const w=`nodes__${r}__layouts__${g.value}`,k=e(w),z=k.findIndex(D=>D.i==_);o({path:`${w}__${z}`,value:{...k[z],w:M,h:f}}),y()},nodeComponents:u,currentLayout:v,columnAmount:i,rowHeight:S,setCoordinates:(_,f,M)=>{const w=v.value.map(z=>(z.i==_&&(z.x=f,z.y=M),z)),k=`nodes__${r}__layouts__${g.value}`;o({path:k,value:w}),y()},layoutSize:g,modals:s,nodeComponentIds:P,currentNode:r,CONSTANTS:Le}}},Wn="/img/drag_arrow.webp";const Yn={class:"canvas"},Xn={class:"modals"},Jn={class:"zoomWrapper"};function Un(t,e,o,n,r,c){const a=K("Navigation"),s=K("Hint"),i=K("Modal"),S=K("grid-item"),O=K("grid-layout");return E(),j("div",Yn,[ve(a,{storeObject:o.storeObject},null,8,["storeObject"]),ve(s,{storeObject:o.storeObject},null,8,["storeObject"]),I("div",Xn,[(E(!0),j(ae,null,re(n.modals,(u,P)=>(E(),W(i,{key:P,storeObject:o.storeObject,modalIndex:P},null,8,["storeObject","modalIndex"]))),128))]),I("div",Jn,[(E(),W(O,{class:"grid",layout:n.currentLayout,"onUpdate:layout":e[0]||(e[0]=u=>n.currentLayout=u),"col-num":n.columnAmount,"row-height":n.rowHeight,"is-draggable":!0,"is-resizable":!0,"vertical-compact":!1,"use-css-transforms":!0,"prevent-collision":!0,onBreakpointChanged:()=>{},key:n.layoutSize,"transform-scale":n.zoomScale,"is-bounded":!0,"restore-on-drag":!0},{default:ce(()=>[(E(!0),j(ae,null,re(n.currentLayout,u=>(E(),W(S,{class:"noPan",key:n.nodeComponentIds[u.i],static:u.static,x:u.x,y:u.y,w:u.w,h:u.h,minW:u.minW??1,minH:u.minH??1,i:n.nodeComponentIds[u.i],"drag-allow-from":`.${n.CONSTANTS.DRAGELEMENTCLASS}`,onMove:n.setCoordinates,onResize:n.updateDimensions,preserveAspectRatio:u.preserveAspectRatio??!0,"data-id":n.nodeComponentIds[u.i]},{default:ce(()=>[I("img",{class:We(["dragHandler",n.CONSTANTS.DRAGELEMENTCLASS]),src:Wn},null,2),(E(),W(Te(n.nodeComponents[n.nodeComponentIds[u.i]].type),{componentID:parseInt(n.nodeComponentIds[u.i]),storeObject:o.storeObject,componentPath:`nodes__${n.currentNode}__components__${parseInt(n.nodeComponentIds[u.i])}`},null,8,["componentID","storeObject","componentPath"]))]),_:2},1032,["static","x","y","w","h","minW","minH","i","drag-allow-from","onMove","onResize","preserveAspectRatio","data-id"]))),128))]),_:1},8,["layout","col-num","row-height","transform-scale"]))])])}const vo=R(Fn,[["render",Un],["__scopeId","data-v-775af240"]]),Kn={name:"FolderTabs",props:{tabs:Object},components:{Button:Ze},setup(){return{clickHandler:e=>{const o=e.currentTarget,n=document.querySelector(".active.tab");n&&n.classList.remove("active"),o!=n&&o.classList.add("active")}}}};const Qn={class:"folderTabs"},eo={class:"title"},to={class:"content"},no=["src"];function oo(t,e,o,n,r,c){const a=K("Button");return E(),j("div",Qn,[(E(!0),j(ae,null,re(o.tabs,(s,i)=>(E(),j("div",{class:"tab",onClick:e[0]||(e[0]=(...S)=>n.clickHandler&&n.clickHandler(...S)),key:i},[I("div",eo,[I("h2",null,oe(s.title),1)]),I("div",to,[I("p",null,oe(s.description),1),s.image?(E(),j("img",{key:0,src:s.image},null,8,no)):te("",!0),ve(a,{label:"Enter",data:s.data,callback:s.handler},null,8,["data","callback"])])]))),128))])}const ao=R(Kn,[["render",oo],["__scopeId","data-v-5a2ff7bf"]]),ro={components:{FolderTabs:ao},props:{storeObject:Object},setup(t){const e=ze(),{getProperty:o,setProperty:n}=t.storeObject,r=o("currentNode"),c=o(`nodes__${r}__pathDescriptions`),a=q(()=>o("previousNode")),s=u=>{const P=o("edges");return Object.entries(P).reduce((g,[v,y])=>(y.includes(u)&&(g=parseInt(v)),g),-1)},i=u=>{var y,d;document.querySelector(".traverse.backward").classList.add("fadeOut");const P=u.target,g=((d=(y=P.parentElement)==null?void 0:y.parentElement)==null?void 0:d.querySelector(".title")).textContent,v=P.dataset.id;n({path:"previousNode",value:r}),n({path:"currentNode",value:v}),n({path:`nodes__${r}__chosenPath`,value:g})},S=u=>{const P=u.currentTarget;P.classList.add("fadeOut");const{to:b}=P.dataset,g=s(parseInt(b));b?(n({path:"previousNode",value:g}),n({path:"currentNode",value:b})):e.push({name:"TaskOverview"})};return{tabs:Object.entries(c).map(([u,P])=>({data:{value:u,name:"id"},handler:i,...P})),previous:a,navigateBackwards:S}}};const so=t=>($e("data-v-cc592b1f"),t=t(),ke(),t),io={class:"branches"},co=["data-to"],lo=so(()=>I("p",null,"►",-1)),uo=[lo];function po(t,e,o,n,r,c){const a=K("FolderTabs");return E(),j("div",io,[I("div",{class:"traverse backward","data-to":n.previous,onClick:e[0]||(e[0]=(...s)=>n.navigateBackwards&&n.navigateBackwards(...s))},uo,8,co),ve(a,{tabs:n.tabs,storeObject:o.storeObject},null,8,["tabs","storeObject"])])}const fo=R(ro,[["render",po],["__scopeId","data-v-cc592b1f"]]);export{vo as C,fo as D};
